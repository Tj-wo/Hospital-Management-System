<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core">
<h:head>
    <title>Manage Appointments</title>
</h:head>
<h:body>
    <h:form id="appointmentForm">
        <div class="card">
            <p:growl id="messages" showDetail="false" life="6000"/>
            <p:dataTable id="appointmentTable" var="appt" value="#{adminAppointmentBean.appointments}" paginator="true" rows="10">
                <f:facet name="header">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span>All Appointments</span>
                        <p:commandButton value="New Appointment" icon="pi pi-plus"
                                         actionListener="#{adminAppointmentBean.prepareNewAppointment}"
                                         oncomplete="PF('appointmentDialog').show()"
                                         update=":dialogForm" process="@this"
                                         styleClass="ui-button-outlined"/>
                    </div>
                </f:facet>
                <p:column headerText="Patient" sortBy="#{appt.patient.fullName}">
                    <h:outputText value="#{appt.patient.fullName}"/>
                </p:column>
                <p:column headerText="Doctor" sortBy="#{appt.doctor.fullName}">
                    <h:outputText value="#{appt.doctor.fullName}"/>
                </p:column>
                <p:column headerText="Date &amp; Time" sortBy="#{appt.appointmentDate}">
                    <h:outputText value="#{appt.appointmentDate}">
                        <f:convertDateTime pattern="yyyy-MM-dd HH:mm"/>
                    </h:outputText>
                </p:column>
                <p:column headerText="Status" sortBy="#{appt.status}">
                    <p:tag value="#{appt.status}" severity="#{appt.status == 'SCHEDULED' ? 'info' : (appt.status == 'COMPLETED' ? 'success' : 'danger')}"/>
                </p:column>
                <p:column headerText="Actions" style="width:8rem; text-align:center;">
                    <p:commandButton icon="pi pi-pencil" title="Edit Appointment"
                                     actionListener="#{adminAppointmentBean.selectAppointmentForEdit(appt)}"
                                     oncomplete="PF('appointmentDialog').show()"
                                     update=":dialogForm" process="@this"/>
                </p:column>
            </p:dataTable>
        </div>
    </h:form>
</h:body>
</html>
